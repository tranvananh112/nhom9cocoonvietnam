<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Theo d√µi ƒë∆°n h√†ng - Cocoon">
    <title>Theo D√µi ƒê∆°n H√†ng - Cocoon</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <div class="header-container">
            <a href="index.html" class="logo">
                <span>üåø</span>
                <div class="logo-text">
                    <strong>The Cocoon</strong>
                    <small>ORIGINAL VIETNAM</small>
                </div>
            </a>
            <nav>
                <a href="index.html">Trang Ch·ªß</a>
                <a href="products.html">S·∫£n Ph·∫©m</a>
                <a href="about.html">V·ªÅ Ch√∫ng T√¥i</a>
                <div class="nav-icons">
                    <button class="icon-btn" data-page="cart">üõí<span class="cart-count" style="display: none;">0</span></button>
                    <button class="icon-btn" data-page="admin" title="Admin">üîí</button>
                </div>
            </nav>
        </div>
    </header>

    <div class="container">
        <section style="margin-top: 40px; margin-bottom: 60px;">
            <h2>Theo D√µi ƒê∆°n H√†ng</h2>

            <div style="max-width: 600px; margin: 40px auto;">
                <div style="margin-bottom: 30px;">
                    <label style="display: block; margin-bottom: 10px; font-weight: 500;">Nh·∫≠p m√£ ƒë∆°n h√†ng:</label>
                    <input type="text" id="orderCode" placeholder="VD: ORD1234567890" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-size: 1em; margin-bottom: 10px;">
                    <button class="btn" onclick="searchOrder()" style="width: 100%;">T√¨m ki·∫øm</button>
                </div>

                <div id="orderDetails" style="display: none;"></div>
                <div id="noOrder" style="text-align: center; padding: 40px; color: #666;">
                    <p>Nh·∫≠p m√£ ƒë∆°n h√†ng ƒë·ªÉ xem th√¥ng tin</p>
                </div>
            </div>

            <h3 style="margin-top: 60px; margin-bottom: 30px; text-align: center; color: #8B6F47;">C√°c ƒê∆°n H√†ng G·∫ßn ƒê√¢y</h3>
            <div id="recentOrders"></div>
        </section>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>V·ªÅ Cocoon</h3>
                <ul>
                    <li><a href="about.html">Gi·ªõi thi·ªáu th∆∞∆°ng hi·ªáu</a></li>
                    <li><a href="#">Gi√° tr·ªã Cocoon</a></li>
                    <li><a href="#">L·ªãch s·ª≠ ph√°t tri·ªÉn</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>H·ªó Tr·ª£</h3>
                <ul>
                    <li><a href="#">Li√™n h·ªá ch√∫ng t√¥i</a></li>
                    <li><a href="#">C√¢u h·ªèi th∆∞·ªùng g·∫∑p</a></li>
                    <li><a href="#">Ch√≠nh s√°ch giao h√†ng</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Theo D√µi</h3>
                <ul>
                    <li><a href="#">Facebook</a></li>
                    <li><a href="#">Instagram</a></li>
                    <li><a href="#">TikTok</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Li√™n H·ªá</h3>
                <ul>
                    <li>Email: info@cocoon.vn</li>
                    <li>Hotline: 1900-xxxx</li>
                    <li>H√† N·ªôi, Vi·ªát Nam</li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 Cocoon - M·ªπ ph·∫©m Thu·∫ßn Chay. T·∫•t c·∫£ quy·ªÅn ƒë∆∞·ª£c b·∫£o l∆∞u.</p>
        </div>
    </footer>

    <script src="js/app.js"></script>
    <script>
        const statusLabels = {
            'pending': '‚è≥ Ch·ªù x√°c nh·∫≠n',
            'confirmed': '‚úì ƒê√£ x√°c nh·∫≠n',
            'shipped': 'üì¶ ƒêang giao',
            'delivered': '‚úì ƒê√£ giao'
        };

        const statusColors = {
            'pending': '#ff9800',
            'confirmed': '#2196f3',
            'shipped': '#9c27b0',
            'delivered': '#4caf50'
        };

        function displayOrder(order) {
            const orderDetails = document.getElementById('orderDetails');
            const noOrder = document.getElementById('noOrder');

            let timeline = '';
            const statuses = ['pending', 'confirmed', 'shipped', 'delivered'];
            const currentIndex = statuses.indexOf(order.status);

            statuses.forEach((status, index) => {
                const isCompleted = index <= currentIndex;
                const isCurrent = index === currentIndex;
                timeline += `
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="width: 40px; height: 40px; margin: 0 auto 10px; border-radius: 50%; background: ${isCompleted ? statusColors[status] : '#ddd'}; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; border: 3px solid white; box-shadow: 0 0 0 3px ${isCompleted ? statusColors[status] : '#ddd'};">
                            ${isCompleted ? '‚úì' : ''}
                        </div>
                        <p style="color: ${isCompleted ? statusColors[status] : '#ccc'}; font-weight: ${isCurrent ? 'bold' : 'normal'}; font-size: 0.95em;">${statusLabels[status]}</p>
                    </div>
                `;
            });

            let itemsHtml = '';
            order.items.forEach(item => {
                itemsHtml += `
                    <div style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #eee;">
                        <div>
                            <span style="font-size: 1.5em;">${item.emoji || 'üì¶'}</span>
                            <span style="margin-left: 10px;">${item.name} x${item.quantity}</span>
                        </div>
                        <span>${new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(item.price * item.quantity)}</span>
                    </div>
                `;
            });

            const html = `
                <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);">
                    <h3 style="margin-bottom: 20px; color: #8B6F47;">M√£ ƒë∆°n h√†ng: ${order.id}</h3>
                    
                    <div style="background: #f9f9f9; padding: 20px; border-radius: 10px; margin-bottom: 30px;">
                        <h4 style="margin-bottom: 15px;">Th√¥ng tin kh√°ch h√†ng</h4>
                        <p><strong>T√™n:</strong> ${order.customer.name}</p>
                        <p><strong>ƒêi·ªán tho·∫°i:</strong> ${order.customer.phone}</p>
                        <p><strong>ƒê·ªãa ch·ªâ:</strong> ${order.customer.address}</p>
                        <p><strong>Ph∆∞∆°ng th·ª©c thanh to√°n:</strong> ${order.paymentMethod === 'cod' ? 'Thanh to√°n khi nh·∫≠n h√†ng' : 'Momo QR Code'}</p>
                    </div>

                    <h4 style="margin-bottom: 15px;">Tr·∫°ng th√°i ƒë∆°n h√†ng</h4>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 30px;">
                        ${timeline}
                    </div>

                    <h4 style="margin-bottom: 15px;">Chi ti·∫øt s·∫£n ph·∫©m</h4>
                    <div style="margin-bottom: 20px;">
                        ${itemsHtml}
                    </div>

                    <div style="background: #f0f0f0; padding: 15px; border-radius: 5px; text-align: right;">
                        <p style="font-size: 1.2em; font-weight: bold; color: #8B6F47;">T·ªïng c·ªông: ${new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(order.total)}</p>
                    </div>
                </div>
            `;

            orderDetails.innerHTML = html;
            orderDetails.style.display = 'block';
            noOrder.style.display = 'none';
        }

        function searchOrder() {
            const code = document.getElementById('orderCode').value.trim().toUpperCase();
            const orders = JSON.parse(localStorage.getItem('cocoon_orders') || '[]');
            const order = orders.find(o => o.id === code);

            if (order) {
                displayOrder(order);
            } else {
                alert('Kh√¥ng t√¨m th·∫•y ƒë∆°n h√†ng');
                document.getElementById('orderDetails').style.display = 'none';
                document.getElementById('noOrder').style.display = 'block';
            }
        }

        // Allow Enter key
        document.getElementById('orderCode').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') searchOrder();
        });

        // Display recent orders
        function displayRecentOrders() {
            const orders = JSON.parse(localStorage.getItem('cocoon_orders') || '[]').reverse().slice(0, 5);
            const container = document.getElementById('recentOrders');

            if (orders.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666;">Ch∆∞a c√≥ ƒë∆°n h√†ng n√†o</p>';
                return;
            }

            let html = '';
            orders.forEach(order => {
                html += `
                    <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 15px; cursor: pointer; transition: all 0.3s;" onclick="displayOrder(${JSON.stringify(order).replace(/"/g, '&quot;')})">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <p style="font-weight: bold; margin-bottom: 5px;">${order.id}</p>
                                <small style="color: #666;">${new Date(order.createdAt).toLocaleString('vi-VN')}</small>
                            </div>
                            <div style="text-align: right;">
                                <p style="font-weight: bold; color: #8B6F47; margin-bottom: 5px;">${new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(order.total)}</p>
                                <span style="background: ${statusColors[order.status]}; color: white; padding: 5px 10px; border-radius: 20px; font-size: 0.85em;">${statusLabels[order.status]}</span>
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        displayRecentOrders();
        cart.updateCartCount();
    </script>
</body>
</html>
